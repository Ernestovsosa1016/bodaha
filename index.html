<script>
    document.getElementById('uploadForm').addEventListener('submit', function(event) {
        event.preventDefault();
        let fileInput = document.getElementById('fileInput');
        let files = fileInput.files;
        let formData = new FormData();

        for (let i = 0; i < files.length; i++) {
            formData.append('file', files[i]);
        }

        fetch('https://bodaha.onrender.com/upload', {
            method: 'POST',
            body: formData
        }).then(response => {
            if (response.ok) {
                alert('Fotos subidas exitosamente.');
                loadGallery();
            } else {
                alert('Error al subir las fotos.');
            }
        }).catch(error => {
            console.error('Error:', error);
        });
    });

    function loadGallery() {
        fetch('https://bodaha.onrender.com/gallery')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Error fetching gallery');
                }
                return response.json();
            })
            .then(data => {
                let gallery = document.getElementById('gallery');
                gallery.innerHTML = '';
                data.images.forEach((image, index) => {
                    let imgElement = document.createElement('img');
                    imgElement.src = image.url;
                    imgElement.alt = 'Foto de Boda';
                    imgElement.onerror = function() {
                        console.error(`Error loading image at ${image.url}`);
                        let errorMessage = document.createElement('p');
                        errorMessage.textContent = `Error al cargar la imagen: ${image.name}`;
                        gallery.appendChild(errorMessage);
                    };
                    gallery.appendChild(imgElement);
                });
            })
            .catch(error => {
                console.error('Error:', error);
            });
    }

    // Load gallery when the page loads
    loadGallery();
</script>
